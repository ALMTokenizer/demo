# <center> ALMTokenizer: A Low-bitrate and Semantic-rich Audio Codec Tokenizer for Audio Language Modeling </center>


## Introduction
Recent advancements in audio language models have underscored the pivotal role of audio tokenization, which converts audio signals into discrete tokens, thereby facilitating the application of language model architectures to the audio domain. In this study, we introduce ALMTokenizer, a novel low-bitrate and semantically rich audio codec tokenizer for audio language models. Prior methods, such as Encodec, typically encode individual audio frames into discrete tokens without considering the use of context information across frames. Unlike these methods, we introduce a novel query-based compression strategy to capture holistic information with a set of learnable query tokens by explicitly modeling the context information across frames. This design not only enables the codec model to capture more semantic information but also encodes the audio signal with fewer token sequences. Additionally, to enhance the semantic information in audio codec models, we introduce the following: (1) A masked autoencoder (MAE) loss, (2) Vector quantization based on semantic priors, and (3) An autoregressive (AR) prediction loss. As a result, ALMTokenizer achieves competitive reconstruction performance relative to state-of-the-art approaches while operating at a lower bitrate. Within the same audio language model framework, ALMTokenizer outperforms previous tokenizers in audio understanding and generation tasks.

## Overview
The overview of ALMTokenizer as following picture shows.
![The overview of SimpleSpeech](fig.png)
In the following, we will show some generated samples by our proposed method. 

<style>
.audio-player {
  width: 200px;
}
.audio-player2 {
  width: 150px;
}
</style>


## Audio Codec Tokenizer Reconstruction Comparison (Speech)

| Original Speech | <center> DAC (1.5kbps) </center> | <center> Encodec (1.5kbps) </center>| <center> WavTokenizer (0.48kbps) </center> | <center> StableCodec (0.4kbps) </center> | <center> SpeechTokenizer (1.5kbps) </center> |<center> Mimi (1.1kbps) </center> | <center> Mimi (0.41kbps) </center> | <center> Ours (0.41kbps) </center> |
| -----------------------     |  -----------   | ------ | ----- |
| <audio class="audio-player2" src="codec/speech/gt/p225_001.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/speech/dac/p225_001.wav" controls preload></audio> | <audio class="audio-player2" src="codec/speech/encodec/p225_001.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/wavtokenizer/p225_001.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/stablecodec/p225_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/speechtokenizer/p225_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_8layer/p225_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_3layer/p225_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/ours/p225_001.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/speech/gt/p225_002.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/speech/dac/p225_002.wav" controls preload></audio> | <audio class="audio-player2" src="codec/speech/encodec/p225_002.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/wavtokenizer/p225_002.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/stablecodec/p225_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/speechtokenizer/p225_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_8layer/p225_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_3layer/p225_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/ours/p225_002.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/speech/gt/p225_003.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/speech/dac/p225_003.wav" controls preload></audio> | <audio class="audio-player2" src="codec/speech/encodec/p225_003.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/wavtokenizer/p225_003.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/stablecodec/p225_003.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/speechtokenizer/p225_003.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_8layer/p225_003.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_3layer/p225_003.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/ours/p225_003.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/speech/gt/p225_004.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/speech/dac/p225_004.wav" controls preload></audio> | <audio class="audio-player2" src="codec/speech/encodec/p225_004.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/wavtokenizer/p225_004.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/stablecodec/p225_004.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/speechtokenizer/p225_004.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_8layer/p225_004.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_3layer/p225_004.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/ours/p225_004.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/speech/gt/p226_002.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/speech/dac/p226_002.wav" controls preload></audio> | <audio class="audio-player2" src="codec/speech/encodec/p226_002.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/wavtokenizer/p226_002.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/stablecodec/p226_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/speechtokenizer/p226_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_8layer/p226_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_3layer/p226_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/ours/p226_002.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/speech/gt/p231_001.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/speech/dac/p231_001.wav" controls preload></audio> | <audio class="audio-player2" src="codec/speech/encodec/p231_001.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/wavtokenizer/p231_001.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/stablecodec/p231_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/speechtokenizer/p231_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_8layer/p231_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_3layer/p231_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/ours/p231_001.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/speech/gt/p231_002.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/speech/dac/p231_002.wav" controls preload></audio> | <audio class="audio-player2" src="codec/speech/encodec/p231_002.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/wavtokenizer/p231_002.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/stablecodec/p231_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/speechtokenizer/p231_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_8layer/p231_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_3layer/p231_002.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/ours/p231_002.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/speech/gt/p232_001.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/speech/dac/p232_001.wav" controls preload></audio> | <audio class="audio-player2" src="codec/speech/encodec/p232_001.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/wavtokenizer/p232_001.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/stablecodec/p232_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/speechtokenizer/p232_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_8layer/p232_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_3layer/p232_001.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/ours/p232_001.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/speech/gt/p266_005.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/speech/dac/p266_005.wav" controls preload></audio> | <audio class="audio-player2" src="codec/speech/encodec/p266_005.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/wavtokenizer/p266_005.wav" controls preload></audio> |  <audio class="audio-player2" src="codec/speech/stablecodec/p266_005.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/speechtokenizer/p266_005.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_8layer/p266_005.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/mimi_3layer/p266_005.wav" controls preload></audio> |<audio class="audio-player2" src="codec/speech/ours/p266_005.wav" controls preload></audio> |

## Audio Codec Tokenizer Reconstruction Comparison (Sound)

| Original Audio | <center> DAC (1.5kbps) </center> | <center> Encodec (1.5kbps) </center>| <center> WavTokenizer (0.48kbps) </center> | <center> Ours (0.41kbps) </center> |
| -----------------------     |  -----------   | ------ | ----- |
| <audio class="audio-player2" src="codec/sound/gt/1-137-A-32.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-137-A-32.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-137-A-32.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-137-A-32.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-137-A-32.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/sound/gt/1-977-A-39.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-977-A-39.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-977-A-39.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-977-A-39.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-977-A-39.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/sound/gt/1-1791-A-26.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-1791-A-26.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-1791-A-26.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-1791-A-26.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-1791-A-26.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/sound/gt/1-4211-A-12.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-4211-A-12.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-4211-A-12.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-4211-A-12.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-4211-A-12.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/sound/gt/1-5996-A-6.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-5996-A-6.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-5996-A-6.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-5996-A-6.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-5996-A-6.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/sound/gt/1-7057-A-12.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-7057-A-12.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-7057-A-12.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-7057-A-12.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-7057-A-12.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/sound/gt/1-7456-A-13.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-7456-A-13.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-7456-A-13.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-7456-A-13.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-7456-A-13.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/sound/gt/1-7973-A-7.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-7973-A-7.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-7973-A-7.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-7973-A-7.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-7973-A-7.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/sound/gt/1-7974-A-49.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-7974-A-49.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-7974-A-49.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-7974-A-49.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-7974-A-49.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/sound/gt/1-7974-B-49.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/sound/dac/1-7974-B-49.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/encodec/1-7974-B-49.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/wavtokenizer/1-7974-B-49.wav" controls preload></audio> | <audio class="audio-player2" src="codec/sound/ours/1-7974-B-49.wav" controls preload></audio> |


## Audio Codec Tokenizer Reconstruction Comparison (Music)

| Original Audio | <center> DAC (1.5kbps) </center> | <center> Encodec (1.5kbps) </center>| <center> WavTokenizer (0.48kbps) </center> | <center> Ours (0.41kbps) </center> |
| -----------------------     |  -----------   | ------ | ----- |
| <audio class="audio-player2" src="codec/music/gt/-0Gj8-vB1q4.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/music/dac/-0Gj8-vB1q4.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/encodec/-0Gj8-vB1q4.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/wavtokenizer/-0Gj8-vB1q4.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/ours/-0Gj8-vB1q4.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/music/gt/-0SdAVK79lg.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/music/dac/-0SdAVK79lg.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/encodec/-0SdAVK79lg.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/wavtokenizer/-0SdAVK79lg.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/ours/-0SdAVK79lg.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/music/gt/-0vPFx-wRRI.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/music/dac/-0vPFx-wRRI.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/encodec/-0vPFx-wRRI.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/wavtokenizer/-0vPFx-wRRI.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/ours/-0vPFx-wRRI.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/music/gt/-1UWSisR2zo.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/music/dac/-1UWSisR2zo.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/encodec/-1UWSisR2zo.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/wavtokenizer/-1UWSisR2zo.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/ours/-1UWSisR2zo.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/music/gt/-3Kv4fdm7Uk.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/music/dac/-3Kv4fdm7Uk.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/encodec/-3Kv4fdm7Uk.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/wavtokenizer/-3Kv4fdm7Uk.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/ours/-3Kv4fdm7Uk.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/music/gt/-88me9bBzrk.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/music/dac/-88me9bBzrk.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/encodec/-88me9bBzrk.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/wavtokenizer/-88me9bBzrk.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/ours/-88me9bBzrk.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/music/gt/-Dtir74TiUM.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/music/dac/-Dtir74TiUM.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/encodec/-Dtir74TiUM.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/wavtokenizer/-Dtir74TiUM.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/ours/-Dtir74TiUM.wav" controls preload></audio> |
| <audio class="audio-player2" src="codec/music/gt/-FFx68qSAuY.wav" controls preload></audio>   | <audio class="audio-player2" src="codec/music/dac/-FFx68qSAuY.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/encodec/-FFx68qSAuY.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/wavtokenizer/-FFx68qSAuY.wav" controls preload></audio> | <audio class="audio-player2" src="codec/music/ours/-FFx68qSAuY.wav" controls preload></audio> |
